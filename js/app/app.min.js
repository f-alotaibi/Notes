var selectedID=-1;const notesListElement=document.getElementById("notesList"),noteTitleElement=document.getElementById("note-title"),noteTextAreaElement=document.getElementById("note-textarea"),noteElement=document.createElement("div");noteElement.classList.add("flex","items-center","justify-between","px-2","py-1","rounded-lg","hover:bg-yellow-200","hover:cursor-pointer"),noteElement.innerHTML='\n<svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n    fill="none"\n    stroke="currentColor"\n    stroke-width="2"\n    stroke-linecap="round"\n    stroke-linejoin="round"\n    class="h-5 w-5 text-yellow-500"\n    >\n    <path d="m9 18 6-6-6-6"></path>\n</svg>\n';const noteSpanElement=document.createElement("span");var selectedElement;function loadApp(){0!=notesMap.size?reload():newNote((function(){loadNotes((function(){id=Array.from(notesMap.keys()).pop(),reload(),loadContent(id)}))}))}function reload(){console.log("reloaded"),notesListElement.innerHTML="";for(let[e,t]of notesMap.entries()){let n=noteElement.cloneNode(!0),o=noteSpanElement.cloneNode(!0);t.title?o.textContent=t.title:(t.content?o.textContent=t.content:o.textContent="Untitled",o.classList.add("italic")),n.prepend(o),n.setAttribute("note-id",e),n.addEventListener("click",(function(){e!=selectedID&&(selectedElement.classList.remove("bg-yellow-200"),selectedElement.classList.remove("hover:cursor-default"),selectedElement.classList.add("hover:cursor-pointer"),selectedElement.classList.add("hover:bg-yellow-200"),loadContent(e))})),notesListElement.appendChild(n)}if(-1==selectedID){let e=localStorage.getItem("selected-id");e&&(e/=1,null==notesMap.get(e)&&(e=notesMap.keys().next().value),loadContent(e))}save()}function loadContent(e){for(child of notesListElement.children)if(child.getAttribute("note-id")==e){child.classList.remove("hover:cursor-pointer"),child.classList.remove("hover:bg-yellow-200"),child.classList.add("bg-yellow-200"),child.classList.add("hover:cursor-default"),selectedElement=child;break}selectedID=e,noteTitleElement.value=notesMap.get(e).title,noteTextAreaElement.value=notesMap.get(e).content,save()}function save(){localStorage.setItem("selected-id",selectedID)}function removeNote(){if(0==notesMap.size)return;let e=selectedID;notesMap.size-1==0?(selectedID=-1,deleteNote(e,(function(){newNote((function(){loadNotes(reload)}))}))):deleteNote(e,(function(){loadNotes((function(){e=Array.from(notesMap.keys()).pop(),reload(),loadContent(e)}))}))}function updateTitle(){selectedElement.removeChild(selectedElement.firstChild);let e=noteSpanElement.cloneNode(!0);noteTitleElement.value?(e.textContent=noteTitleElement.value,e.classList.contains("italic")&&e.classList.remove("bg-yellow-200")):(noteTextAreaElement.value?e.textContent=noteTextAreaElement.value:e.textContent="Untitled",e.classList.add("italic")),child.prepend(e)}noteSpanElement.classList.add("text-sm","text-yellow-900","select-none","truncate"),document.getElementById("note-trash").addEventListener("click",(function(){removeNote()})),document.getElementById("note-add").addEventListener("click",(function(){newNote((function(){loadNotes((function(){id=Array.from(notesMap.keys()).pop(),reload(),loadContent(id)}))}))})),document.getElementById("note-sidebar-button").addEventListener("click",(function(){"none"==document.getElementById("note-sidebar").style.display?document.getElementById("note-sidebar").style.display="block":document.getElementById("note-sidebar").style.display="none"})),noteTextAreaElement.addEventListener("input",(function(){notesMap.get(selectedID).content=noteTextAreaElement.value,noteTitleElement.value||updateTitle(),saveNote(selectedID)})),noteTitleElement.addEventListener("input",(function(){notesMap.get(selectedID).title=noteTitleElement.value,updateTitle(),saveNote(selectedID)})),loadNotes(loadApp);